#       Sgourakis Lab
#   Author: Sagar Gupta
#   Date: April 28, 2022
#   Email: sagarg@sas.upenn.edu

# import required libraries
import argparse
import csv
from collections import defaultdict

# import custom libraries


def get_supertype(allele):

    st_val = ''

    for st, alleles in supertypes.items():
        if allele in alleles:
            st_val = st

    if st_val == '':
        st_val = 'NA'
    elif st_val == 'Unclassified':
        st_val = allele[0]+'_Unclassified'

    return st_val

# via Sidney, et al., 2008 (doi.org/10.1186/1471-2172-9-1)
supertypes = defaultdict(dict)

supertypes['A01']=['A0101', 'A0103', 'A0104', 'A0106', 'A0107', 'A0108', 'A0109', 'A0110', 'A0111', 'A0112', 'A0114', 'A0115', 'A2501', 'A2502', 'A2504', 'A2601', 'A2602', 'A2603', 'A2604', 'A2605', 'A2606', 'A2607', 'A2608', 'A2609', 'A2610', 'A2611', 'A2612', 'A2613', 'A2614', 'A2615', 'A2617', 'A2618', 'A2619', 'A2621', 'A2622', 'A2623', 'A2624', 'A2626', 'A3002', 'A3003', 'A3004', 'A3006', 'A3009', 'A3012', 'A3110', 'A3201', 'A3202', 'A3203', 'A3204', 'A3205', 'A3206', 'A3207', 'A3208', 'A3209', 'A3210', 'A3601', 'A3602', 'A3603', 'A3604', 'A7410', 'A8001']

supertypes['A02']=['A0201', 'A0202', 'A0203', 'A0204', 'A0205', 'A0206', 'A0207', 'A0209', 'A0211', 'A0212', 'A0213', 'A0214', 'A0215', 'A0216', 'A0217', 'A0218', 'A0219', 'A0220', 'A0221', 'A0222', 'A0224', 'A0225', 'A0226', 'A0227', 'A0228', 'A0230', 'A0231', 'A0236', 'A0237', 'A0238', 'A0239', 'A0240', 'A0241', 'A0242', 'A0243', 'A0244', 'A0245', 'A0246', 'A0247', 'A0248', 'A0249', 'A0250', 'A0251', 'A0254', 'A0256', 'A0257', 'A0258', 'A0259', 'A0260', 'A0261', 'A0262', 'A0263', 'A0266', 'A0267', 'A0268', 'A0269', 'A0270', 'A0271', 'A0272', 'A0273', 'A0274', 'A0275', 'A0277', 'A0278', 'A0279', 'A0282', 'A0283', 'A0284', 'A0285', 'A0286', 'A6802', 'A6815', 'A6827', 'A6828', 'A6901']

supertypes['A01 A03']=['A0252', 'A3001', 'A3008', 'A3011', 'A3013', 'A3014', 'A3015', 'A6806', 'A6807']

supertypes['A03']=['A0265', 'A0280', 'A0301', 'A0302', 'A0304', 'A0305', 'A0306', 'A0307', 'A0308', 'A0309', 'A0310', 'A0312', 'A0313', 'A0314', 'A0316', 'A0317', 'A1101', 'A1102', 'A1103', 'A1104', 'A1105', 'A1106', 'A1107', 'A1108', 'A1109', 'A1110', 'A1112', 'A1113', 'A1114', 'A1115', 'A1116', 'A1120', 'A1121', 'A1122', 'A1123', 'A3101', 'A3103', 'A3104', 'A3105', 'A3106', 'A3109', 'A3111', 'A3112', 'A3301', 'A3303', 'A3304', 'A3305', 'A3306', 'A3307', 'A3402', 'A3403', 'A3404', 'A3406', 'A6601', 'A6602', 'A6603', 'A6604', 'A6801', 'A6803', 'A6804', 'A6805', 'A6808', 'A6809', 'A6810', 'A6812', 'A6813', 'A6814', 'A6816', 'A6819', 'A6820', 'A6821', 'A6822', 'A6823', 'A6824', 'A6825', 'A6826', 'A7401', 'A7402', 'A7403', 'A7404', 'A7405', 'A7406', 'A7407', 'A7408', 'A7409', 'A7411']

supertypes['A24']=['A2301', 'A2302', 'A2303', 'A2304', 'A2305', 'A2306', 'A2307', 'A2308', 'A2310', 'A2312', 'A2402', 'A2403', 'A2405', 'A2406', 'A2408', 'A2409', 'A2410', 'A2411', 'A2413', 'A2417', 'A2418', 'A2420', 'A2421', 'A2422', 'A2423', 'A2425', 'A2426', 'A2427', 'A2428', 'A2429', 'A2430', 'A2433', 'A2434', 'A2435', 'A2437', 'A2438', 'A2439', 'A2440', 'A2441', 'A2442', 'A2443', 'A2444', 'A2446', 'A2447', 'A2448', 'A2449', 'A2452']

supertypes['A01 A24']=['A2901', 'A2902', 'A2903', 'A2905', 'A2906', 'A2909', 'A2910', 'A2911', 'A2912', 'A2913']

supertypes['B07']=['B0702', 'B0703', 'B0704', 'B0705', 'B0706', 'B0707', 'B0709', 'B0712', 'B0714', 'B0715', 'B0716', 'B0717', 'B0718', 'B0719', 'B0720', 'B0721', 'B0722', 'B0723', 'B0724', 'B0725', 'B0726', 'B0730', 'B0731', 'B0733', 'B0734', 'B0735', 'B0736', 'B0737', 'B0739', 'B0740', 'B0741', 'B0742', 'B0743', 'B1508', 'B3501', 'B3502', 'B3503', 'B3504', 'B3505', 'B3506', 'B3507', 'B3508', 'B3509', 'B3511', 'B3512', 'B3514', 'B3515', 'B3517', 'B3518', 'B3521', 'B3522', 'B3524', 'B3529', 'B3530', 'B3531', 'B3532', 'B3533', 'B3534', 'B3535', 'B3536', 'B3537', 'B3538', 'B3539', 'B3540', 'B3541', 'B3542', 'B3543', 'B3544', 'B3545', 'B3546', 'B3551', 'B3553', 'B3554', 'B3555', 'B3557', 'B3558', 'B3560', 'B3561', 'B3806', 'B3807', 'B3910', 'B3916', 'B3917', 'B4201', 'B4204', 'B4205', 'B4206', 'B4406', 'B5101', 'B5102', 'B5103', 'B5104', 'B5105', 'B5106', 'B5108', 'B5109', 'B5110', 'B5111', 'B5112', 'B5113', 'B5114', 'B5116', 'B5117', 'B5118', 'B5119', 'B5120', 'B5121', 'B5123', 'B5124', 'B5126', 'B5128', 'B5129', 'B5130', 'B5131', 'B5132', 'B5133', 'B5134', 'B5135', 'B5136', 'B5137', 'B5138', 'B5301', 'B5302', 'B5304', 'B5306', 'B5308', 'B5310', 'B5401', 'B5403', 'B5404', 'B5406', 'B5407', 'B5501', 'B5502', 'B5503', 'B5504', 'B5505', 'B5507', 'B5508', 'B5509', 'B5510', 'B5511', 'B5513', 'B5514', 'B5515', 'B5517', 'B5519', 'B5601', 'B5602', 'B5603', 'B5604', 'B5605', 'B5609', 'B5610', 'B5611', 'B5612', 'B5613', 'B5615', 'B5616', 'B6701', 'B7801', 'B7802', 'B7804', 'B8101', 'B8102']

supertypes['B08']=['B0801', 'B0802', 'B0803', 'B0807', 'B0808', 'B0809', 'B0811', 'B0812', 'B0813', 'B0815', 'B0816', 'B0818', 'B0819', 'B0820', 'B0821', 'B0822', 'B0823', 'B0824', 'B0825',
                    'B0832', 'B0852'] # added manually

supertypes['B62']=['B1309', 'B1313', 'B1501', 'B1502', 'B1504', 'B1505', 'B1507', 'B1512', 'B1513', 'B1514', 'B1515', 'B1519', 'B1520', 'B1524', 'B1525', 'B1528', 'B1530', 'B1531', 'B1533', 'B1534', 'B1535', 'B1538', 'B1539', 'B1540', 'B1542', 'B1545', 'B1548', 'B1550', 'B1555', 'B1558', 'B1560', 'B1563', 'B1565', 'B1570', 'B1573', 'B1575', 'B1578', 'B1581', 'B1582', 'B1583', 'B1585', 'B1586', 'B1588', 'B1592', 'B1596', 'B1597', 'B3528', 'B4021', 'B4408', 'B4601', 'B4602', 'B4603', 'B4604', 'B4605', 'B5201', 'B5202', 'B5203', 'B5204', 'B5205', 'B5207', 'B5208', 'B7805', 'B9502', 'B9504']

supertypes['B27']=['B1401', 'B1402', 'B1403', 'B1405', 'B1406', 'B1407', 'B1503', 'B1509', 'B1510', 'B1518', 'B1523', 'B1537', 'B1547', 'B1549', 'B1551', 'B1552', 'B1554', 'B1561', 'B1562', 'B1568', 'B1569', 'B1572', 'B1574', 'B1580', 'B1590', 'B1591', 'B1593', 'B1598', 'B1599', 'B2701', 'B2702', 'B2703', 'B2704', 'B2705', 'B2706', 'B2707', 'B2709', 'B2710', 'B2711', 'B2713', 'B2714', 'B2715', 'B2717', 'B2719', 'B2720', 'B2721', 'B2724', 'B2725', 'B2727', 'B2728', 'B2730', 'B3526', 'B3801', 'B3805', 'B3809', 'B3810', 'B3811', 'B3901', 'B3902', 'B3903', 'B3904', 'B3905', 'B3906', 'B3907', 'B3908', 'B3909', 'B3911', 'B3913', 'B3914', 'B3915', 'B3918', 'B3923', 'B3924', 'B3926', 'B3927', 'B3928', 'B3929', 'B3930', 'B3932', 'B3933', 'B3934', 'B4012', 'B4440', 'B4801', 'B4802', 'B4803', 'B4804', 'B4805', 'B4807', 'B4808', 'B4809', 'B4810', 'B4811', 'B4812', 'B4813', 'B5518', 'B7301', 'B9503']

supertypes['B58']=['B1516', 'B1517', 'B1567', 'B1595', 'B5701', 'B5702', 'B5703', 'B5704', 'B5705', 'B5706', 'B5707', 'B5708', 'B5709', 'B5801', 'B5802', 'B5804', 'B5805', 'B5806', 'B5807', 'B5808', 'B5809', 'B5811']

supertypes['B44']=['B1546', 'B1553', 'B1801', 'B1802', 'B1803', 'B1805', 'B1806', 'B1810', 'B1811', 'B1813', 'B1814', 'B1815', 'B1819', 'B1820', 'B3701', 'B3704', 'B4001', 'B4002', 'B4003', 'B4004', 'B4005', 'B4006', 'B4009', 'B4010', 'B4011', 'B4014', 'B4015', 'B4016', 'B4018', 'B4019', 'B4020', 'B4023', 'B4024', 'B4026', 'B4028', 'B4029', 'B4030', 'B4033', 'B4034', 'B4035', 'B4036', 'B4038', 'B4039', 'B4040', 'B4042', 'B4043', 'B4044', 'B4045', 'B4047', 'B4048', 'B4049', 'B4050', 'B4051', 'B4052', 'B4053', 'B4054', 'B4055', 'B4056', 'B4057', 'B4058', 'B4059', 'B4101', 'B4102', 'B4103', 'B4104', 'B4106', 'B4107', 'B4402', 'B4403', 'B4404', 'B4405', 'B4407', 'B4413', 'B4414', 'B4416', 'B4420', 'B4421', 'B4422', 'B4424', 'B4425', 'B4426', 'B4427', 'B4428', 'B4429', 'B4430', 'B4431', 'B4432', 'B4433', 'B4434', 'B4435', 'B4436', 'B4437', 'B4438', 'B4439', 'B4441', 'B4442', 'B4501', 'B4502', 'B4503', 'B4504', 'B4505', 'B4507', 'B4704', 'B4705', 'B4904', 'B5001', 'B5002', 'B5004']

supertypes['Unclassified']=['A0102', 'A0113', 'A0208', 'A0210', 'A0229', 'A0233', 'A0234', 'A0235', 'A0255', 'A0264', 'A0276', 'A0281', 'A0315', 'A1111', 'A1117', 'A1118', 'A1119', 'A2309', 'A2404', 'A2407', 'A2414', 'A2415', 'A2419', 'A2424', 'A2431', 'A2432', 'A2450', 'A2451', 'A2453', 'A2503', 'A2616', 'A2620', 'A2904', 'A2907', 'A2914', 'A3007', 'A3010', 'A3102', 'A3107', 'A3108', 'A3308', 'A3401', 'A3405', 'A4301', 'A6817', 'B0708', 'B0710', 'B0711', 'B0713', 'B0727', 'B0728', 'B0729', 'B0732', 'B0738', 'B0804', 'B0805', 'B0806', 'B0810', 'B0814', 'B0817', 'B1301', 'B1302', 'B1303', 'B1304', 'B1306', 'B1307', 'B1308', 'B1310', 'B1311', 'B1312', 'B1404', 'B1506', 'B1511', 'B1521', 'B1527', 'B1529', 'B1532', 'B1536', 'B1543', 'B1544', 'B1556', 'B1557', 'B1564', 'B1566', 'B1571', 'B1576', 'B1577', 'B1584', 'B1587', 'B1589', 'B1804', 'B1807', 'B1808', 'B1809', 'B1812', 'B1818', 'B2708', 'B2712', 'B2716', 'B2718', 'B2723', 'B2726', 'B2729', 'B3510', 'B3513', 'B3516', 'B3519', 'B3520', 'B3523', 'B3525', 'B3527', 'B3547', 'B3548', 'B3549', 'B3550', 'B3552', 'B3556', 'B3702', 'B3705', 'B3706', 'B3707', 'B3708', 'B3709', 'B3802', 'B3803', 'B3804', 'B3808', 'B3912', 'B3919', 'B3920', 'B3922', 'B3931', 'B4007', 'B4008', 'B4013', 'B4025', 'B4027', 'B4037', 'B4046', 'B4060', 'B4061', 'B4105', 'B4202', 'B4409', 'B4410', 'B4411', 'B4412', 'B4415', 'B4417', 'B4418', 'B4506', 'B4701', 'B4702', 'B4703', 'B4806', 'B4901', 'B4902', 'B4903', 'B5107', 'B5115', 'B5122', 'B5206', 'B5303', 'B5305', 'B5307', 'B5309', 'B5402', 'B5405', 'B5512', 'B5516', 'B5606', 'B5607', 'B5608', 'B5614', 'B5901', 'B6702', 'B7803', 'B8201', 'B8202', 'B8301', 'B9501']
